#!/bin/bash

echo " "

echo -e "\e[95m=========================================================================================================================================== \e[0m"
echo "building winnipeg..."
echo -e "\e[95m=========================================================================================================================================== \e[0m"

cd ..
. build.sh
cd programs
echo -e "\e[34m=========================================================================================================================================== \e[0m"

echo " "

for folder in `ls all-testers/M2`
do
	echo -e "\e[92m=========================================================================================================================================== \e[0m"
	echo "Entering folder: ${folder}"
	echo -e "\e[92m=========================================================================================================================================== \e[0m"

	cd "all-testers/M2/${folder}"
	for file in `ls`
	do
		# echo "${file}"
		echo "Testing ${file} on winnipeg"
		../../../../src/winnipeg typecheck < "${file}"
	done
	cd ..
	cd ..
	cd ..

	echo -e "\e[34m=========================================================================================================================================== \e[0m"
	echo " "
done

echo -e "\e[104m cleaning up... \e[0m"
cd ../src
make clean
cd ..
cd programs
echo " "
